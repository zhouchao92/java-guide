#### ACID是靠什么保证的？
- **Atomicity**（**原子性**）一个事务内的所有操作是一个整体，要么全部成功，要么全部失败。
- **Consistency**（**一致性**）几个并行执行的事务，其执行结果必须与按某一顺序串行执行的结果相一致。
- **Isolation**（**隔离性**）事务的执行不受其他事务的干扰，事务执行的中间结果对其他事务必须是透明的。
- **Durability**（**持久性**）对于任意已提交事务，系统必须保证该事务对数据库的改变不被丢失，即使数据库出现故障。

- 原子性：undolog日志，记录需要回滚的日志信息，事务回滚时撤销已执行的SQL
- 一致性：由其他三个特性保证
- 隔离性：写写（锁），写读--MVCC
- 持久性：redolog日志，mysql修改数据库时在日志中记录一份日志数据，即使数据没有保存成功，只要日志保存成功，数据不会丢失

buffer pool--> 提高查询效率，redolog 保证磁盘的顺序写入

#### 事务的隔离级别
- 脏读：一个未提交事务读取到另一个未提交事务的数据
- 不可重复读：一个未提交的事务读取到另一提交事务修改的数据
- 幻读：一个未提交事务读取到另一提交事务添加的数据

| **隔离级别**                             | **脏读** | **不可重复读** | **幻读** |
|------------------------------------------|----------|----------------|----------|
| READ_UNCOMMITED（读未提交）              | 有       | 有             | 有       |
| READ_COMMITTED（读已提交，不可重复读）   | 无       | 有             | 有       |
| REPEATABLE_READ（可重复读）【MySQL默认】 | 无       | 无             | 有       |
| SERIALIZABLE（串行化）                   | 无       | 无             | 无       |

MVVC 只能解决多事务下的幻读，当前事务下的幻读需要用间隙锁

读已提交 RC：语句级快照

可重复读 RR：事务级快照

串行化：查询加读锁，更新（增、删、改）加写锁（阻塞） select ... lock in share mode ，select ... for update

RR 和 RC 下，update 会加行锁（另一种方式加乐观锁）

